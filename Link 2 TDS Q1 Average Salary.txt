# Practice Link
https://towardsdatascience.com/10-problems-to-practice-almost-all-sql-concepts-37545e7c5219

Q1. Average Salary
Given two tables below, write a query to display the comparison 
result (higher/lower/same) of the 
average salary of employees in a department to the companyâ€™s average salary.



select distinct pay_month, dep_id , case when dep_avg > company avg then 'higher'
				   when dep_avg < company avg then 'lower'
					else 'same' end as status from
(

select  concat(extract(year from pay_date), '-', extract(month from pay_date)) as pay_month, dep_id, 
avg(amount)over(partition by dep_id,  concat(extract(year from pay_date), '-', extract(month from pay_date))) as dep_avg,
avg(amount)over(partition by  concat(extract(year from pay_date), '-', extract(month from pay_date))) as company_avg,

 from
salary s join department dep
on s.employee_id=dep.employee_id

) t1


