# Practice Link
https://towardsdatascience.com/twenty-five-sql-practice-exercises-5fc791e24082

8. Upgrade rate by product action (hard)
Given the following two tables, return the fraction of users, rounded to two 
decimal places, who accessed feature two (type: F2 in events table) 
and upgraded to premium within the first 30 days of signing up.


Select sum (case when datediff(join_date,p_date) <=30 then 1 else 0 end)/ (select count(*) from users)
From 
(
(Select user_id , access_date as f2_date from
Events
Where type =‘F2’ )t1
Join
(Select user_id , access_date as p_date from
Events
Where type =‘P’)
On t1.user_id=t2.user_id
) t3
Join users
On users.user_id = t3.user_id

-------- another way------- 
8/26/2025
---------------------------
Select count(distinct user_id)/ (select count(*) from users) as upgrade  from
(Select user_id, type, access_date, join_date , datedidd(access_date,join_date) as days_between from 
Users join
Events
On users.user_id=events.user_id) T1
Where type = P and 
days_between <=30
And user_id in (select distinct user_id from events where type=‘F2’)
